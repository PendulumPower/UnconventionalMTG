<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Set – UnconventionalMTG Archive</title>
<link rel="stylesheet" href="../../style.css">
<style>
.card-container {
    perspective: 1000px;
    display: inline-block;
    margin: 5px;
}

.card-inner {
    position: relative;
    width: 200px;
    height: 280px;
    transform-style: preserve-3d;
    transition: transform 0.6s;
    cursor: pointer;
}

.card-inner.flipped {
    transform: rotateY(180deg);
}

.card-inner img {
    position: absolute;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    backface-visibility: hidden;
}

.card-inner .back {
    transform: rotateY(180deg);
}
</style>
</head>

<body>
<header>
    <h1>Hollow Knight Silksong (HKS)</h1>
    <p>A custom Magic: The Gathering set</p>
</header>

<div class="back-button-container">
    <a class="back-button" href="../index.html">← Back to Sets</a>
</div>

<main>
    <section class="card-grid" id="card-grid"></section>
</main>

<footer>
    <p>© 2026 UnconventionalMTG — Created by Pendulum</p>
</footer>

<script>
async function loadCards() {
    try {
        const response = await fetch(`./cards.json`);
        if (!response.ok) throw new Error("Could not load cards.json");
        const data = await response.json();

        const grid = document.getElementById("card-grid");

        // Group by base ID
        const cardMap = {};
        data.cards.forEach(card => {
            // Extract base id (before decimal)
            const match = card.id.match(/^(\d+)\./);
            const baseId = match ? match[1] : card.id;
            if (!cardMap[baseId]) cardMap[baseId] = [];
            cardMap[baseId].push(card);
        });

        Object.values(cardMap).forEach(cards => {
            if (cards.length === 2) {
                // Double-faced
                const container = document.createElement("div");
                container.className = "card-container";

                const inner = document.createElement("div");
                inner.className = "card-inner";

                const front = document.createElement("img");
                front.src = `./Cards/${cards[0].file}`;
                front.alt = cards[0].file;

                const back = document.createElement("img");
                back.src = `./Cards/${cards[1].file}`;
                back.alt = cards[1].file;
                back.className = "back";

                inner.appendChild(front);
                inner.appendChild(back);

                inner.addEventListener("click", () => {
                    inner.classList.toggle("flipped");
                });

                container.appendChild(inner);
                grid.appendChild(container);
            } else {
                // Single-faced
                const img = document.createElement("img");
                img.src = `./Cards/${cards[0].file}`;
                img.alt = cards[0].file;
                img.addEventListener("click", () => {
                    window.location.href = `viewer.html?img=${cards[0].file}`;
                });
                grid.appendChild(img);
            }
        });

    } catch (err) {
        console.error("Error loading cards:", err);
    }
}

loadCards();
</script>
</body>
</html>
